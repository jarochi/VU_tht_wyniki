---
title: "Prezentacja wyników ThT - seminarium"
output: 
  ioslides_presentation: 
    widescreen: yes
widescreen: true
---

```{r, echo=FALSE,message=FALSE,warning=FALSE}
library(dplyr)
library(readODS)
library(reshape2)
library(ggplot2)
library(ggbeeswarm)
library(tidyverse)
library(DT)

peptydy <- read.csv("amyloid_heatmap.csv")
peptydy <- peptydy[1:(nrow(peptydy)-1),]
peptydy <- peptydy %>% mutate(match = ifelse(peptydy[["AmyLoad"]] == peptydy[["ThT"]], "yes", "no"))

peptydy <- peptydy %>% gather("method", "result", 2:4)

pep_order <- filter(peptydy, method == "AmyLoad") %>% arrange(result) %>%  pull(peptide) %>% as.character

peptydy[["peptide"]] <- factor(peptydy[["peptide"]], levels = pep_order)

p <- ggplot(peptydy, aes(x = method, y = peptide, fill = result)) +
  geom_tile() +
  geom_tile(aes(fill = result), color = "white") +
  # scale_fill_manual(values=c("red", "lightgreen")) +
  scale_x_discrete(limits=c("AmyLoad","ThT","match")) +
  theme_bw() +
  theme(text = element_text(size=9))


marlena <- read.csv("amyloid_heatmap_Marlena.csv")
marlena <- marlena[1:(nrow(marlena)-1),]
marlena <- marlena %>% gather("method", "result", 2:5)

pep_order_m <- filter(marlena, method == "AmyLoad") %>% arrange(result) %>%  pull(peptide) %>% as.character

marlena[["peptide"]] <- factor(marlena[["peptide"]], levels = pep_order_m)

M <- ggplot(marlena, aes(x = method, y = peptide, fill = result)) +
  geom_tile() +
  geom_tile(aes(fill = result), color = "white") +
  # scale_fill_manual(values=c("red", "lightgreen")) +
  scale_x_discrete(limits=c("AmyLoad","ThT", "Marlena", "Vytautas")) +
  theme_bw() +
  theme(text = element_text(size=9))


pp <- read.csv("amyloid_repeats.csv")
pp <- pp %>% gather("day", "intensity", 2:16)

pp$day <- pp$day %>% str_replace("X", "")

pp1 <- pp %>% mutate(
           day = sapply(strsplit(day, split = "_"), first),
           pow = sapply(strsplit(day, split = "_"), last),
           pow2 = rep(1:3, each=25, times=5))

pp2 <- pp1 %>% group_by(peptides, day, pow2) %>% 
    summarise(intensity = median(intensity)) %>%
  summarise(intensity = median(intensity))
  
M_plot <- pp2 %>% ggplot(aes(x=peptides, y=intensity, fill=day)) +
  geom_col(position = "dodge") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
  

pep_10 <- read.csv("VU_10_peptides.csv")
pep_10 <- pep_10 %>% gather("method", "result", 2:5)

pep_order_10 <- filter(pep_10, method == "AmyLoad") %>% arrange(result) %>%  pull(Peptyd) %>% as.character

pep_10[["Peptyd"]] <- factor(pep_10[["Peptyd"]], levels = pep_order_10)

plot_10 <- ggplot(pep_10, aes(x = method, y = Peptyd, fill = result)) +
  geom_tile() +
  geom_tile(aes(fill = result), color = "white") +
  # scale_fill_manual(values=c("red", "lightgreen")) +
  scale_x_discrete(limits=c("AmyLoad","Marlena", "Vytautas")) +
  theme_bw() +
  theme(text = element_text(size=9))


inner_join(pp2, peptydy, by=c("peptides" = "peptide")) %>% 
  group_by(peptides) %>% 
  mutate(norm_intensity = intensity / max(intensity)) %>% 
  filter(method == "AmyLoad") %>% 
  ggplot(aes(x=peptides, y=norm_intensity, fill=day)) +
  geom_col(position = "dodge") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
  
```


## Overview

Created: 2018-11-28.

Parsed: `r Sys.Date()`.

## Amyloidy

<style>

.column-left1{
  float: left;
  width: 45%;
  text-align: left;
}

.column-right1{
  float: right;
  width: 55%;
  text-align: right;
}
img {
    width: auto;
    height: auto;
    object-fit: cover;
}
.fill {object-fit: fill;}
.contain {object-fit: contain;}
.cover {object-fit: cover;}
.scale-down {object-fit: scale-down;}
.none {object-fit: none;}
</style>

<div class="column-left1">
- skupiska białek lub polipeptydów, które uległy nieprawidłowemu sfałdowaniu

- zbudowane głównie ze struktur β

- włókna amyloidowe są nierozpuszczalne i wysoce odporne na degradację

- skłonność peptydu do tworzenia amyloidu zależy od kilku czynników, takich jak ładunek
polipeptydowy, sekwencja, hydrofobowość i struktura wtórna
</div>

<div class="column-right1">
<img class="cover" src="fig/amyloid_alzh.png" style="width:100%">
</div>

<!-- ## Alzheimer -->

<!-- <img class="scale-down" src="fig/amyloid_alzh.png" style="width:95%" -->

## Niektóre choroby powodowane przez amyloidy

- Alzheimer

- Parkinson

- cukrzyca typu II

- Creutzfeldta-Jakoba

- Huntington

- amyloidoza

- katarakta

## Amyloidy funkcjonalne

- występują w wielu systemach biologicznych

- wykryte w bakteriach, grzybach, insektach oraz ssakach

Funkcje:

- biorą udział w tworzeniu biofilmów

- dziedziczenie epigenetyczne

- pajęcze nici

- produkcja melaniny

- bakteriobójcze odpowiedzi immunologiczne

## Curli

- system curli jest podstawowym białkowym składnikiem strukturalnym biofilmów

- curli to funkcjonalne nanowłókna amyloidalne 

- curli posiada dwa niezależnie operony: csgBAC i csgDEFG

- nanowłókna curli mają nieskomplikowaną konstrukcję
funkcjonalne włókna amyloidalne są bardzo odporne na działanie wysokich temperatur i czynników denatujących
- włókna amyloidalne mogą stanowić 10-40% całkowitej objętości biowłókien biofilmu

- system curli wywodzi się z E. coli

- system curli jest najlepiej przetestowanym systemem pozakomórkowych funkcjonalnych amyloidów

## operon csgBAC i csgDEFG
<style>

.column-left1{
  float: left;
  width: 40%;
  text-align: left;
}

.column-right1{
  float: right;
  width: 60%;
  text-align: right;
}
img {
    width: auto;
    height: auto;
    object-fit: cover;
}
.fill {object-fit: fill;}
.contain {object-fit: contain;}
.cover {object-fit: cover;}
.scale-down {object-fit: scale-down;}
.none {object-fit: none;}
</style>

<div class="column-right1">
CsgA - duża podjednostka curli

CsgB - mała podjednostka curli, nukleator  

CsgC - inhibitor csgA     

CsgD - master regulator wzrostu biofilmów

CsgE - peryplazmatyczne białko pomocnicze, kieruje csgA do poru  

CsgF - abiałko pomocnicze ułatwiające csgB przyczepienie się do powierzchnii komórki

CsgG - por przez, który na zewnątrz wydostają się csgA
</div>

<div class="column-left1">
<img class="cover" src="fig/operon.jpg" style="width:90%">
</div>

<!-- ## operon csgBAC i csgDEFG -->

<!-- <img class="cover" src="fig/operon.jpg" style="width:40%"> -->

## Cel

Amylogram - narzędzie przewidujące amyloidogenność, zostało wykorzystane do przeszukania sekwencji zdeponowanych w różnych amyloidowych bazach danych.

AmyloGram znalazł 24 peptydy, które różniły się przewidywaniem przez program oraz informacjami w bazach.

## Metody

Do sprawdzenia właściwości amyloidogennych użyliśmy metody ThT.

Peptydy rozpuściliśmy w 100uL of 0.1M NaOH, łagodnie wymieszaliśmy i zneutralizowaliśmy pH do 7 przy wykorzystaniu 50mM NaH2PO4.

## ThT

- ThT jest naładowany dodatnio

- wiązania elektrostatyczne z ujemnie naładowymi resztami

- rzadziej wiąże się do surface ridges β-kartek, oddziałując  z hydrofobowymi resztami

- zmiana intensywności jest zależna od ilości miejsc wiążących ThT a nie stężenia włókien

On the surface of a cross-β structure, amino acids form repetitive “surface ridges” of specific residues.

## Wyniki

```{r, echo=FALSE,message=FALSE,warning=FALSE,fig.width=5,fig.height=2.8}
plot_10
```

## Wyniki

```{r, echo=FALSE,message=FALSE,warning=FALSE,fig.width=5,fig.height=2.8}
p
```

## Wyniki

```{r, echo=FALSE,message=FALSE,warning=FALSE,fig.width=5,fig.height=2.8}
M
```

## Wyniki

```{r, echo=FALSE,message=FALSE,warning=FALSE,fig.width=5,fig.height=2.8}
M_plot
```

## Podsumowanie


